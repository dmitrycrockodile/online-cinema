import { useEffect, useState } from "react";
import useMovieService from "../../services/MovieService";

import MainButton from "../mainButton/MainButton";
import ErrorMessage from "../errorMessage/ErrorMessage";

import styles from "./filmItem.module.scss";

const FilmItem = ({id}) => {
   const [movie, setMovie] = useState({});

   const { getMovie, error } = useMovieService();

   useEffect(() => {
      getMovie(id).then(res => onMovieLoaded(res));

      window.scrollTo(0, 0);
   }, [id])

   const onMovieLoaded = (movie) => {
      setMovie(movie);
   }

   return (
      <div className={styles.root}>
         {error ? <ErrorMessage style={{'margin': '0 auto'}}/> : <View data={movie}/>}
      </div>
   );
}

const View = ({data}) => {
   const {adult, highQualityImg, lowQualityImg, date, description, title, rating, voteCount} = data;

   return (
      <>
         <div className={styles.left}>
            <img className={styles.filmImage} srcSet={`${lowQualityImg} 1x, ${highQualityImg} 2x`} alt={title} />
         </div>
         <div className={styles.right}>
            <div className={styles.info}>
               <h1 className={styles.title}>{title}</h1>
               <div className={styles.bookmarks}>
                  {adult ? <span className={styles.adultMarker}>18+</span> : null}
                  <button className={styles.save}>
                     <svg viewBox="0 0 25 30" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 4.88889C2 3.2934 3.34315 2 5 2H20C21.6569 2 23 3.2934 23 4.88889V28L12.5 22.9444L2 28V4.88889Z" stroke="#EC8F32" strokeWidth="2.3" strokeLinecap="round" strokeLinejoin="round"/>
                     </svg>
                  </button>
               </div>
               <p className={styles.date}>Date: {date}</p>
               <div className={styles.rating}>
                  <span className={styles.mark}>{rating}</span>
                  <div className={styles.votes}>
                     <p>Рейтинг аудитерии</p>
                     <span>{voteCount} оценок</span>
                  </div>
               </div>
            </div>
            <p className={styles.description}>{description}</p>
            <ul className={styles.socials}>
               <li>
                  <a href="/">
                     <svg className={styles.vk} viewBox="0 0 31 18" xmlns="http://www.w3.org/2000/svg">
                        <path fillRule="evenodd" clipRule="evenodd" d="M30.2804 1.23889C30.5018 0.536935 30.2804 0.032969 29.247 0.032969H25.8333C25.5201 0.0178788 25.2098 0.0981056 24.9453 0.262553C24.6809 0.427001 24.4753 0.667543 24.3571 0.950908C23.3362 3.38138 21.9696 5.65958 20.2976 7.71845C19.5042 8.4924 19.1536 8.74438 18.7292 8.74438C18.3048 8.74438 18.194 8.4924 18.194 7.77245V1.22089C18.194 0.374946 17.9357 -0.00302858 17.2161 -0.00302858H11.828C11.7183 -0.0103602 11.6083 0.00409916 11.5045 0.0394728C11.4008 0.0748464 11.3055 0.130398 11.2244 0.202762C11.1433 0.275125 11.0781 0.362793 11.0328 0.460455C10.9875 0.558117 10.963 0.663738 10.9607 0.770919C10.9607 1.56287 12.1786 1.76085 12.3077 3.9927V8.87037C12.3077 9.9323 12.1232 10.1123 11.6804 10.1123C10.5363 10.1123 7.75 5.99057 6.14464 1.27489C5.73869 0.356947 5.425 -0.00302858 4.55774 -0.00302858H1.14405C0.166071 -0.00302858 0 0.446941 0 0.932908C0 1.79685 1.14405 6.15256 5.35119 11.9122C6.45383 13.6583 7.96889 15.1217 9.76977 16.18C11.5706 17.2384 13.605 17.861 15.703 17.9958C17.8619 17.9958 18.1202 17.5278 18.1202 16.7178V13.712C18.1202 12.7401 18.3232 12.5781 19.006 12.5781C19.6887 12.5781 20.3899 12.8481 22.4012 14.738C24.6893 16.9698 25.0768 17.9958 26.3685 17.9958H29.7452C30.7232 17.9958 31.1845 17.5098 30.9262 16.5919C30.2102 15.1445 29.2425 13.8292 28.0661 12.7041C27.2911 11.8222 26.1101 10.8142 25.7411 10.3463C25.372 9.87831 25.372 9.44633 25.7411 8.87037C25.7042 8.87037 29.8375 3.16476 30.2804 1.23889Z"/>
                     </svg>
                  </a>
               </li>
               <li>
                  <a href="/">
                     <svg className={styles.insta} viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <g clipPath="url(#clip0_359_1830)">
                           <path d="M10 1.8C7.3375 1.8 7.025 1.8 5.9625 1.8C5.32923 1.79846 4.70144 1.91723 4.1125 2.15C3.67504 2.29896 3.28037 2.55207 2.9625 2.8875C2.62869 3.20913 2.37224 3.60235 2.2125 4.0375C1.99318 4.63458 1.87489 5.26403 1.8625 5.9C1.8625 6.95 1.8625 7.2625 1.8625 9.9375C1.8625 12.6125 1.8625 12.925 1.8625 13.975C1.87202 14.6113 1.9904 15.2412 2.2125 15.8375C2.37224 16.2727 2.62869 16.6659 2.9625 16.9875C3.28299 17.3227 3.67655 17.5793 4.1125 17.7375C4.70426 17.9589 5.3307 18.0731 5.9625 18.075C7.025 18.075 7.3375 18.075 10 18.075C12.6625 18.075 12.9875 18.075 14.0375 18.075C14.6735 18.0741 15.3042 17.9598 15.9 17.7375C16.3344 17.5762 16.7273 17.32 17.05 16.9875C17.3838 16.6659 17.6403 16.2727 17.8 15.8375C18.0223 15.2417 18.1366 14.611 18.1375 13.975C18.1375 12.925 18.1375 12.6125 18.1375 9.9375C18.1375 7.2625 18.1375 6.95 18.1375 5.9C18.1337 5.2643 18.0195 4.6341 17.8 4.0375C17.6358 3.6046 17.38 3.21231 17.05 2.8875C16.73 2.5547 16.336 2.30204 15.9 2.15C15.3055 1.92159 14.6744 1.803 14.0375 1.8C12.9875 1.8125 12.675 1.8 10 1.8ZM10 0C12.7125 0 13.0625 0 14.125 0C14.9537 0.0156192 15.7737 0.172014 16.55 0.4625C17.218 0.712769 17.8236 1.10515 18.325 1.6125C18.8256 2.11936 19.217 2.72346 19.475 3.3875C19.7939 4.17965 19.9716 5.02154 20 5.875C20 6.9375 20.0625 7.2875 20.0625 10C20.0625 12.7125 20.0625 13.05 20 14.125C19.9844 14.9537 19.828 15.7737 19.5375 16.55C19.2872 17.218 18.8949 17.8236 18.3875 18.325C17.8827 18.8282 17.278 19.2199 16.6125 19.475C15.8203 19.7939 14.9785 19.9716 14.125 20C13.05 20 12.7125 20.0625 10 20.0625C7.2875 20.0625 6.95 20 5.875 20C5.0463 19.9844 4.22628 19.828 3.45 19.5375C2.78204 19.2872 2.17641 18.8948 1.675 18.3875C1.1744 17.8806 0.78301 17.2765 0.525 16.6125C0.234514 15.8362 0.0781192 15.0162 0.0625 14.1875C0.0625 13.1125 0.0625 12.775 0.0625 10.0625C0.0625 7.35 0.0625 7 0.0625 5.9375C0.0781192 5.1088 0.234514 4.28878 0.525 3.5125C0.772345 2.84307 1.16511 2.23684 1.675 1.7375C2.17641 1.23015 2.78204 0.837769 3.45 0.5875C4.21847 0.253474 5.03887 0.0547181 5.875 0C6.95 0 7.2875 0 10 0Z"/>
                           <path d="M10 4.86232C11.0166 4.85985 12.0111 5.15905 12.8576 5.72206C13.7041 6.28507 14.3646 7.08657 14.7553 8.02511C15.1461 8.96364 15.2496 9.99701 15.0528 10.9944C14.856 11.9918 14.3677 12.9084 13.6497 13.6281C12.9317 14.3479 12.0163 14.8384 11.0194 15.0377C10.0225 15.2369 8.98885 15.1359 8.04936 14.7474C7.10988 14.359 6.30677 13.7005 5.7417 12.8554C5.17663 12.0102 4.875 11.0165 4.875 9.99982C4.875 8.63943 5.41455 7.33458 6.37532 6.37147C7.33608 5.40836 8.63962 4.86563 10 4.86232ZM10 13.3373C10.6606 13.3398 11.3071 13.1462 11.8576 12.7809C12.4081 12.4157 12.8378 11.8953 13.0923 11.2857C13.3469 10.6761 13.4148 10.0046 13.2874 9.3564C13.16 8.70817 12.8431 8.11232 12.3769 7.64431C11.9106 7.1763 11.316 6.85719 10.6682 6.72739C10.0205 6.5976 9.34878 6.66296 8.7382 6.91519C8.12762 7.16743 7.60563 7.5952 7.23835 8.14431C6.87107 8.69343 6.675 9.33919 6.675 9.99982C6.67499 10.8828 7.02491 11.7298 7.64811 12.3554C8.27131 12.9809 9.11701 13.334 10 13.3373Z"/>
                           <path d="M4.66309 5.8623C4.41586 5.8623 4.17419 5.78899 3.96862 5.65164C3.76306 5.51429 3.60285 5.31907 3.50824 5.09066C3.41363 4.86225 3.38887 4.61092 3.4371 4.36844C3.48534 4.12597 3.60439 3.90324 3.7792 3.72842C3.95402 3.55361 4.17675 3.43456 4.41922 3.38632C4.6617 3.33809 4.91303 3.36285 5.14144 3.45746C5.36985 3.55207 5.56507 3.71228 5.70242 3.91784C5.83978 4.1234 5.91309 4.36508 5.91309 4.61231C5.91309 4.94383 5.78139 5.26177 5.54697 5.49619C5.31255 5.73061 4.99461 5.8623 4.66309 5.8623Z"/>
                        </g>
                        <defs>
                           <clipPath id="clip0_359_1830">
                              <rect width="20" height="20" fill="white"/>
                           </clipPath>
                        </defs>
                     </svg>
                  </a>
               </li>
               <li>
                  <a href="/">
                     <svg className={styles.fb} viewBox="0 0 21 20" xmlns="http://www.w3.org/2000/svg">
                        <path fillRule="evenodd" clipRule="evenodd" d="M10.5001 -8.27047e-05C13.143 -0.00210902 15.6894 0.951347 17.631 2.66991C19.5726 4.38847 20.7664 6.74567 20.974 9.27086C21.1817 11.796 20.3879 14.3034 18.7512 16.2922C17.1145 18.2811 14.7554 19.6051 12.1448 19.9999V12.9681H14.5826L15.0492 10.0614H12.1448V8.17208C12.1233 7.95555 12.1532 7.73716 12.2323 7.53327C12.3113 7.32939 12.4375 7.14528 12.6013 6.99474C12.7651 6.8442 12.9623 6.73111 13.1782 6.66396C13.394 6.59681 13.6229 6.57732 13.8478 6.60696H15.1658V4.12513C14.3938 4.00956 13.6143 3.94605 12.833 3.93508C12.2917 3.8963 11.7481 3.97185 11.2406 4.15639C10.7331 4.34094 10.2741 4.62998 9.89585 5.00313C9.51764 5.37628 9.22948 5.82443 9.05172 6.31597C8.87395 6.8075 8.81091 7.33044 8.86704 7.84788V10.0838H6.19588V12.9904H8.85538V20.0223C6.21008 19.6635 3.80701 18.3517 2.13576 16.354C0.464516 14.3563 -0.349154 11.823 -0.139472 9.27036C0.07021 6.7177 1.28747 4.33769 3.2643 2.61524C5.24112 0.892794 7.82878 -0.0425001 10.5001 -8.27047e-05Z"/>
                     </svg>
                  </a>
               </li>
               <li>
                  <a href="/">
                     <svg className={styles.youTube} viewBox="0 0 29 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M28.3836 3.1538C28.2239 2.54885 27.9035 1.99592 27.4547 1.55107C27.0058 1.10621 26.4446 0.785261 25.8279 0.620756C22.0698 0.174222 18.2854 -0.0269775 14.4998 0.018495C10.7143 -0.0269775 6.92985 0.174222 3.1717 0.620756C2.55167 0.782534 1.9867 1.10227 1.53451 1.54731C1.08232 1.99235 0.759127 2.54672 0.597946 3.1538C0.185063 5.41624 -0.0151461 7.71085 -0.00017849 10.0089C-0.0155363 12.3078 0.190793 14.603 0.616072 16.8641C0.775696 17.469 1.09617 18.022 1.54499 18.4668C1.99381 18.9117 2.55501 19.2326 3.1717 19.3971C6.92985 19.8437 10.7143 20.0449 14.4998 19.9994C18.2854 20.0449 22.0698 19.8437 25.8279 19.3971C26.448 19.2354 27.0129 18.9156 27.4651 18.4706C27.9173 18.0255 28.2405 17.4712 28.4017 16.8641C28.8146 14.6017 29.0148 12.307 28.9998 10.0089C29.0152 7.71005 28.8089 5.41486 28.3836 3.1538ZM11.5273 14.2248V5.79312L19.1217 10.0089L11.5273 14.2248Z"/>
                     </svg>
                  </a>
               </li>
            </ul>
            <div className={styles.watch}>
               <MainButton 
                  value="Watch trailer"
                  size="medium"
                  type="transparent"
                  border="orangeBorder"
                  color="orangeColor"
               />
               <MainButton 
                  value="Watch online for free"
                  size="mediumBig"
                  type="fullOrange"
               />
            </div>
         </div>
      </>
   )
}

export default FilmItem;